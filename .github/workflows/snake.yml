# GitHub Action for generating a contribution graph with a snake eating your contributions.
name: Generate snake game

# Controls when the action will run.
on:
	schedule:
	- cron: '0 */12 * * *'

# This command allows us to run the Action automatically from the Actions tab.
	workflow_dispatch:

# Also run on every push on the master branch
	push:
		branches:
		- snake

# The sequence of runs in this workflow:
jobs:
	# This workflow contains a single job called "build"
	build:
		# The type of runner that the job will run on
		runs-on: ubuntu-latest
		
		# Steps represent a sequence of tasks that will be executed as part of the job
		steps:
			- name: Clone repo
				uses: actions/checkout@master

			- name: Generate the snake files in './dist/'
				uses: Sutil/snk@master
				id: snake-gif
				with:
					github_user_name: ${{ github.repository_owner }}
					svg_out_path: dist/github-contribution-grid-snake2.svg
					snake_color: 'green'

			- name: Deploy to GitHub Pages
				uses: crazy-max/ghaction-github-pages@v3.1.0
				with:
					target_branch: output
					build_dir: dist
				env:
					GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

			- name: Show build status
				run: git status

			- name: Push new files to the output branch
				uses: crazy-max/ghaction-github-pages@v3.1.0
				with:
					target_branch: output
					build_dir: dist
					commit_message: 'Update snake animations'
				env:
					GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
